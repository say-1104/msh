#include "optfem.h"

extern int matNxNx(double g1[3][3], double wl, double *p)
{
  g1[0][0] = (37.0/30.0*p[0]-1.0/10.0*p[1]+6.0/5.0*p[2])/wl;
  g1[0][1] = (7.0/30.0*(p[0]+p[1])-2.0/15.0*p[2])/wl;
  g1[0][2] = (-22.0/15.0*p[0]-2.0/15.0*p[1]-16.0/15.0*p[2])/wl;
  g1[1][1] = (-1.0/10.0*p[0]+37.0/30.0*p[1]+6.0/5.0*p[2])/wl;
  g1[1][2] = (-2.0/15.0*p[0]-22.0/15.0*p[1]-16.0/15.0*p[2])/wl;
  g1[2][2] = (8.0/5.0*(p[0]+p[1])+32.0/15.0*p[2])/wl;
  g1[1][0] = g1[0][1];
  g1[2][0] = g1[0][2];
  g1[2][1] = g1[1][2];
}

extern int matNN(double g6[3][3], double wl, double *p)
{
  g6[0][0] = (13.0/140.0*p[0]-1.0/140.0*p[1]+1.0/21.0*p[2])*wl;
  g6[0][1] = (-1.0/140.0*(p[0]+p[1])-2.0/105.0*p[2])*wl;
  g6[0][2] = (1.0/21.0*p[0]-2.0/105.0*p[1]+4.0/105.0*p[2])*wl;
  g6[1][1] = (-1.0/140.0*p[0]+13.0/140.0*p[1]+1.0/21.0*p[2])*wl;
  g6[1][2] = (-2.0/105.0*p[0]+1.0/21.0*p[1]+4.0/105.0*p[2])*wl;
  g6[2][2] = (4.0/105.0*(p[0]+p[1])+16.0/35.0*p[2])*wl;
  g6[1][0] = g6[0][1];
  g6[2][0] = g6[0][2];
  g6[2][1] = g6[1][2];
}

extern int matNxN(double g6[3][3])
{
  g6[0][0] = -1.0/2.0;  g6[0][1] =  1.0/6.0;  g6[0][2] = -2.0/3.0;
  g6[1][0] = -g6[0][1]; g6[1][1] =  1.0/2.0;  g6[1][2] =  2.0/3.0;
  g6[2][0] = -g6[0][2]; g6[2][1] = -g6[1][2]; g6[2][2] =  0.0;
}

extern int matNNx(double g6[3][3])
{
  g6[0][0] = -1.0/2.0;  g6[0][1] = -1.0/6.0;  g6[0][2] =  2.0/3.0;
  g6[1][0] = -g6[0][1]; g6[1][1] =  1.0/2.0;  g6[1][2] = -2.0/3.0;
  g6[2][0] = -g6[0][2]; g6[2][1] = -g6[1][2]; g6[2][2] =  0.0;
}

extern int matNNc(double_complex g6[3][3], double wl, double_complex *p)
{
  g6[0][0] = (13.0/140.0*p[0]-1.0/140.0*p[1]+1.0/21.0*p[2])*wl;
  g6[0][1] = (-1.0/140.0*(p[0]+p[1])-2.0/105.0*p[2])*wl;
  g6[0][2] = (1.0/21.0*p[0]-2.0/105.0*p[1]+4.0/105.0*p[2])*wl;
  g6[1][1] = (-1.0/140.0*p[0]+13.0/140.0*p[1]+1.0/21.0*p[2])*wl;
  g6[1][2] = (-2.0/105.0*p[0]+1.0/21.0*p[1]+4.0/105.0*p[2])*wl;
  g6[2][2] = (4.0/105.0*(p[0]+p[1])+16.0/35.0*p[2])*wl;
  g6[1][0] = g6[0][1];
  g6[2][0] = g6[0][2];
  g6[2][1] = g6[1][2];
}

extern int matNNxc(double_complex g6[3][3])
{
  g6[0][0] = -1.0/2.0;  g6[0][1] = -1.0/6.0;  g6[0][2] =  2.0/3.0;
  g6[1][0] = -g6[0][1]; g6[1][1] =  1.0/2.0;  g6[1][2] = -2.0/3.0;
  g6[2][0] = -g6[0][2]; g6[2][1] = -g6[1][2]; g6[2][2] =  0.0;
}
